
    <table class="table table-sm w-100 m-0 mb-sm-1 mb-md-2">
        <tbody>
            <!-- Header -->
            <tr class="table-secondary">
                <td>
                    <div class="small fw-bold"><?=$tableMainCaptionTimeUnit?></div>
                </td>
                <td class="d-none d-sm-table-cell">
                    <div class="small fw-bold">Einkauf</div>
                </td>
                <td class="d-none d-md-table-cell">
                    <div class="small fw-bold">Einspeisung</div>
                </td>
                <td>
                    <div class="small fw-bold">Ersparnis</div>
                </td>
                <td class="d-none d-lg-table-cell">
                    <div class="small fw-bold">Gesamtverbrauch</div>
                </td>
                <td>
                    <div class="small fw-bold"><span class="d-none d-md-inline">Fehlende Werte</span></div>
                </td>
            </tr>

            <!-- Row 1 -->
            <tr class="table-light">
                <td>
                    <div class="small"><?=$tableRow1CaptionTimeUnit?></div>
                </td>
                <td class="d-none d-sm-table-cell">
                    <div class="small"><?=HtmlHelper::formatEnergyInWattAndCurrency($overviewPageService->getEMOverZeroTotal1())?></div>
                </td>
                <td class="d-none d-md-table-cell">
                    <div class="small"><?=HtmlHelper::formatEnergyInWattAndCurrency($overviewPageService->getEMUnderZeroTotal1())?></div>
                </td>
                <td>
                    <div class="small"><?=HtmlHelper::formatEnergyInWattAndCurrency($overviewPageService->getPMSavingsTotal1(), $overviewPageService->getAutarkyInPercent1())?></div>
                </td>
                <td class="d-none d-lg-table-cell">
                    <div class="small"><?=HtmlHelper::formatEnergyInWattAndCurrency($overviewPageService->getConsumptionTotal1())?></div>
                </td>
                <td>
                    <a href="#" class="btn btn-sm btn-mising-values btn-<?=HtmlHelper::prepareFailureStyle($overviewPageService->getMissingRowSet1()->getWorstMissingRowCountPercent())?>" data-bs-toggle="popover" data-bs-content="#missingRowSetTable1" data-bs-trigger="focus">
                        <span class="d-none d-md-inline"><?=$overviewPageService->getMissingRowSet1()->getWorstMissingRowCountPercent()?>%</span>
                        <i class="bi bi-caret-down-fill"></i>
                    </a>
                </td>
            </tr>

            <?php if (isset($tableRow2CaptionTimeUnit)) { ?>
            <!-- Row 2 -->
            <tr class="table-light">
                <td>
                    <div class="small"><?=$tableRow2CaptionTimeUnit?></div>
                </td>
                <td class="d-none d-sm-table-cell">
                    <div class="small"><?=HtmlHelper::formatEnergyInWattAndCurrency($overviewPageService->getEMOverZeroTotal2())?></div>
                </td>
                <td class="d-none d-md-table-cell">
                    <div class="small"><?=HtmlHelper::formatEnergyInWattAndCurrency($overviewPageService->getEMUnderZeroTotal2())?></div>
                </td>
                <td>
                    <div class="small"><?=HtmlHelper::formatEnergyInWattAndCurrency($overviewPageService->getPMSavingsTotal2(), $overviewPageService->getAutarkyInPercent2())?></div>
                </td>
                <td class="d-none d-lg-table-cell">
                    <div class="small"><?=HtmlHelper::formatEnergyInWattAndCurrency($overviewPageService->getConsumptionTotal2())?></div>
                </td>
                <td>
                    <a href="#" class="btn btn-sm btn-mising-values btn-<?=HtmlHelper::prepareFailureStyle($overviewPageService->getMissingRowSet2()->getWorstMissingRowCountPercent())?>" data-bs-toggle="popover" data-bs-content="#missingRowSetTable2" data-bs-trigger="focus">
                        <span class="d-none d-md-inline"><?=$overviewPageService->getMissingRowSet2()->getWorstMissingRowCountPercent()?>%</span>
                        <i class="bi bi-caret-down-fill"></i>
                    </a>
                </td>
            </tr>
            <?php } ?>
        </tbody>
    </table>
    <div class="p-1"></div>


<!-- Popover content for missing values 1+2 -->
 <?=HtmlHelper::renderPopoverFailureTemplate($overviewPageService->getMissingRowSet1(), "missingRowSetTable1");?>
 <?=HtmlHelper::renderPopoverFailureTemplate($overviewPageService->getMissingRowSet2(), "missingRowSetTable2");?>
